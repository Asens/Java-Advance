---
description: 对象的可达性分析和垃圾回收算法
---
# 垃圾回收

Java中，内存由虚拟机管理，控制着回收什么，什么时候回收，怎么回收。

在栈中内存的随线程产生和分配，销毁而回收，在堆中，需要制定一系列策略来判断该回收哪些区域，以及何时回收。

## 可达性分析

主流的做法是通过可达性分析来判断对象是否存活。存在一些根节点（GC Roots）作为起始点，从这些节点向下搜索，通过的路径为引用链，当对象与GC Roots间不存在任何引用链时，该对象不再被需要。

GC Root包括：

- 虚拟机栈中引用的对象
- 方法区中类静态属性引用的对象
- 方法区常量引用的对象
- Native方法引用的对象

**引用**

Java为引用提供了四种级别，除了强引用之外，还有其他引用，在垃圾回收时有着不同的表现

- 强引用：默认的引用方式，引用还在，对象就不会被回收
- 软引用（SoftReference）：垃圾回收后内存不够用会在软引用中再回收一次，还没有足够内存，则内存溢出
- 弱引用（WeekReference）：垃圾收集时，回收
- 虚引用：最弱的关系，当对象被收集时，可以获得通知

**标记**

